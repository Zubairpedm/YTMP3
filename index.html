<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Converter Concept</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* Dark background */
        }
        .container-card {
            background-color: #161b22; /* Slightly lighter card background */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        }
        .convert-button {
            transition: transform 0.1s ease, box-shadow 0.2s ease;
        }
        .convert-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 211, 153, 0.4);
        }
        .download-button {
            animation: pulse-download 1.5s infinite;
        }
        @keyframes pulse-download {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(52, 211, 153, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(52, 211, 153, 0);
            }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div id="app" class="container-card w-full max-w-2xl p-6 md:p-10 rounded-xl border border-gray-700">

        <!-- Header -->
        <h1 class="text-3xl font-bold text-center text-green-400 mb-2">Media Converter Hub</h1>
        <p class="text-center text-gray-400 mb-8">Paste your video link to convert and download media files.</p>

        <!-- Input and Control Area -->
        <div class="space-y-6">

            <!-- 1. URL Input -->
            <div>
                <label for="video-url" class="block text-sm font-medium text-gray-300 mb-2">Video Link (URL)</label>
                <input type="url" id="video-url" placeholder="e.g., https://www.youtube.com/watch?v=..."
                       class="w-full p-3 rounded-lg bg-gray-800 border border-gray-600 focus:ring-green-500 focus:border-green-500 text-white"
                       value="https://www.example.com/video-for-learning-purposes"
                       required>
            </div>

            <!-- 2. Format and Quality Selection -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Format Dropdown -->
                <div>
                    <label for="format-select" class="block text-sm font-medium text-gray-300 mb-2">Output Format</label>
                    <select id="format-select" onchange="updateQualityOptions()"
                            class="w-full p-3 rounded-lg bg-gray-800 border border-gray-600 focus:ring-green-500 focus:border-green-500 text-white appearance-none pr-8">
                        <option value="mp3">Audio (MP3)</option>
                        <option value="mp4">Video (MP4)</option>
                    </select>
                </div>
                <!-- Quality Dropdown (Dynamically updated by JS) -->
                <div>
                    <label for="quality-select" class="block text-sm font-medium text-gray-300 mb-2">Quality</label>
                    <select id="quality-select"
                            class="w-full p-3 rounded-lg bg-gray-800 border border-gray-600 focus:ring-green-500 focus:border-green-500 text-white appearance-none pr-8">
                        <!-- Options filled by JavaScript -->
                    </select>
                </div>
            </div>

            <!-- 3. Conversion Button -->
            <button id="convert-button" onclick="startConversion()"
                    class="convert-button w-full p-4 mt-6 text-lg font-semibold text-gray-900 bg-green-400 hover:bg-green-300 rounded-lg focus:outline-none focus:ring-4 focus:ring-green-500 focus:ring-opacity-50 flex items-center justify-center">
                <span id="button-text">Start Conversion</span>
                <svg id="loading-spinner" class="animate-spin -ml-1 mr-3 h-5 w-5 text-gray-900 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </button>
        </div>

        <!-- 4. Status and Download Area -->
        <div id="status-area" class="mt-8 pt-6 border-t border-gray-700 space-y-4">
            <div id="status-message" class="text-center text-lg font-medium text-gray-400">Awaiting URL...</div>
            <div id="download-link-container" class="hidden">
                <a id="download-link" href="#" download
                   class="download-button w-full text-center block p-4 text-xl font-bold text-gray-900 bg-green-500 hover:bg-green-600 rounded-lg shadow-lg">
                   Download Your File
                </a>
            </div>
            <!-- Progress Bar (Conceptual) -->
            <div id="progress-bar-container" class="hidden">
                <div class="relative pt-1">
                    <div class="overflow-hidden h-3 mb-4 text-xs flex rounded bg-gray-600">
                        <div id="progress-bar" style="width:0%" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500 transition-all duration-500"></div>
                    </div>
                </div>
                <p id="progress-text" class="text-sm text-gray-400 text-center">0% - Fetching details...</p>
            </div>
        </div>

    </div>

    <script>
        // --- Configuration for Quality Options ---
        const QUALITY_OPTIONS = {
            mp3: [
                { value: '320', label: 'High Quality (320 kbps)' },
                { value: '192', label: 'Standard Quality (192 kbps)' },
                { value: '128', label: 'Low Quality (128 kbps)' },
            ],
            mp4: [
                { value: '1080', label: 'Full HD (1080p)' },
                { value: '720', label: 'HD (720p)' },
                { value: '480', label: 'Standard (480p)' },
                { value: '360', label: 'Mobile (360p)' },
            ]
        };

        // --- DOM Element References ---
        const urlInput = document.getElementById('video-url');
        const formatSelect = document.getElementById('format-select');
        const qualitySelect = document.getElementById('quality-select');
        const convertButton = document.getElementById('convert-button');
        const buttonText = document.getElementById('button-text');
        const loadingSpinner = document.getElementById('loading-spinner');
        const statusMessage = document.getElementById('status-message');
        const downloadLinkContainer = document.getElementById('download-link-container');
        const downloadLink = document.getElementById('download-link');
        const progressBarContainer = document.getElementById('progress-bar-container');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');

        /**
         * Updates the Quality dropdown based on the selected format (MP3 or MP4).
         */
        function updateQualityOptions() {
            const selectedFormat = formatSelect.value;
            const options = QUALITY_OPTIONS[selectedFormat];

            // Clear existing options
            qualitySelect.innerHTML = '';

            // Add new options
            options.forEach(option => {
                const opt = document.createElement('option');
                opt.value = option.value;
                opt.textContent = option.label;
                qualitySelect.appendChild(opt);
            });
        }

        /**
         * Sets the application state to loading/processing.
         * @param {string} message - The status message to display.
         */
        function setLoading(message) {
            convertButton.disabled = true;
            convertButton.classList.add('opacity-60', 'cursor-not-allowed');
            buttonText.textContent = message;
            loadingSpinner.classList.remove('hidden');
            statusMessage.textContent = 'Status: ' + message;
            downloadLinkContainer.classList.add('hidden');
            progressBarContainer.classList.remove('hidden');
            setProgressBar(0, '0% - Starting process...');
        }

        /**
         * Sets the application state back to ready/initial.
         * @param {string} message - The status message to display.
         * @param {boolean} isError - If true, displays the message as an error.
         */
        function setReady(message, isError = false) {
            convertButton.disabled = false;
            convertButton.classList.remove('opacity-60', 'cursor-not-allowed');
            buttonText.textContent = 'Start Conversion';
            loadingSpinner.classList.add('hidden');
            statusMessage.textContent = isError ? 'Error: ' + message : message;
            statusMessage.classList.toggle('text-red-400', isError);
            statusMessage.classList.toggle('text-gray-400', !isError);
            progressBarContainer.classList.add('hidden');
        }

        /**
         * Updates the visual progress bar and text.
         * @param {number} percentage - The percentage of progress (0-100).
         * @param {string} text - The detailed progress text.
         */
        function setProgressBar(percentage, text) {
            const clampedPercent = Math.min(100, Math.max(0, percentage));
            progressBar.style.width = clampedPercent + '%';
            progressText.textContent = `${clampedPercent}% - ${text}`;
        }


        /**
         * Main function to start the conversion process (conceptual).
         * NOTE: The actual video processing requires a back-end server
         * that can use tools like yt-dlp and FFmpeg, which cannot be
         * run in this client-side environment. This function only simulates the process.
         */
        async function startConversion() {
            const videoUrl = urlInput.value.trim();
            const format = formatSelect.value;
            const quality = qualitySelect.value;

            if (!videoUrl || !videoUrl.startsWith('http')) {
                setReady('Please enter a valid URL.', true);
                return;
            }

            console.log(`Starting conversion for: ${videoUrl}`);
            console.log(`Format: ${format}, Quality: ${quality}`);

            setLoading('Connecting to server...');

            // --- CONCEPTUAL API CALL SIMULATION ---
            // In a real application, you would make a POST request here:
            // const response = await fetch('/api/convert', { method: 'POST', body: JSON.stringify({ url: videoUrl, format: format, quality: quality }) });

            try {
                // Simulate various stages of the conversion process
                await simulateDelay(1000); // Wait for connection

                setProgressBar(20, 'Downloading video source...');
                await simulateDelay(2500); // Simulate download time

                setProgressBar(50, `Converting to ${format.toUpperCase()} (${quality} quality)...`);
                await simulateDelay(3000); // Simulate conversion time

                setProgressBar(90, 'Finalizing file and generating download link...');
                await simulateDelay(1500); // Simulate finalization

                setProgressBar(100, 'Done!');

                // Simulate success and getting a download URL
                const mockDownloadUrl = `data/converted-file-${Date.now()}.${format}`; // This would be a real server-generated URL
                const mockFileName = `converted_media_${quality}.${format}`;

                showDownloadLink(mockDownloadUrl, mockFileName);
                setReady('Conversion successful! Your file is ready.', false);

            } catch (error) {
                console.error("Conversion simulation failed:", error);
                setReady('Conversion failed. Server communication error.', true);
            }
        }

        /**
         * Helper function to simulate network delay.
         * @param {number} ms - Delay in milliseconds.
         */
        function simulateDelay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        /**
         * Shows the final download link button.
         * @param {string} url - The final download URL.
         * @param {string} filename - The suggested file name for the download attribute.
         */
        function showDownloadLink(url, filename) {
            downloadLink.href = url;
            downloadLink.setAttribute('download', filename);
            downloadLinkContainer.classList.remove('hidden');
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            updateQualityOptions();
        });
    </script>
</body>
</html>
